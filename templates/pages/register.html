{% extends 'base.html' %} {% load static %} {% block content %}

<main>
  <div class="popup_container_booklets">
    <div class="blocker_booklets"></div>
    <div class="policies_popup_booklets">
      <div class="close_booklets"></div>
      <div class="booklet_pop_content">
        <div class="booklet-img">
          <img src="{% static 'images/IC/486884.webp' %}" alt="" />
        </div>
        <div class="booklet_right">
          <h3>Check out our booklets</h3>
          <ul>
            <li>
              <div class="booklet">
                <p>For the visa booklet</p>
                <a
                  href="https://docs.google.com/presentation/d/1MZD6IKTnrXErKgVGJ2oTziH6I63k2SWWhClek8t-GMk/edit"
                  target="_blank"
                  >Click Here</a
                >
              </div>
            </li>
            <li>
              <div class="booklet">
                <p>For the delegation booklet</p>
                <a
                  href="https://docs.google.com/presentation/d/1J5YETZ2HJJvVJpoaV_w9VwwF36HBdMu-4UPKJR2Yj_o/edit"
                  target="_blank"
                  >Click Here</a
                >
              </div>
            </li>
            <li>
              <div class="booklet">
                <p>For the best route booklet</p>
                <a
                  href="https://docs.google.com/presentation/d/16xkPDdECFXibZzc_N-tua3gpjzX3ndDvjHNvu6maCT4/edit"
                  target="_blank"
                  >Click Here</a
                >
              </div>
            </li>
          </ul>
        </div>
      </div>
    </div>
  </div>
  <section class="register_hero">
    <div class="reg-hero-content">
      <h1 style="color: white">Register Now!</h1>
      <!-- <p style="font-family: 'Caliburn';     text-align: center;"cali">5th Round of Registrations will be opened soon</p> -->
      <div id="flip"></div>
    </div>

    <picture style="width: 100%">
      <source
        media="(max-width: 786px)"
        srcset="{% static 'images/IC/Mobile Banner.webp' %}"
      />
      <source
        media="(min-width: 787px)"
        srcset="{% static 'images/IC/registration_website.webp' %}"
      />
      <img
        src="{% static 'images/IC/registration_website.webp' %}"
        alt=""
        width="100%"
      />
    </picture>
  </section>

  <div class="background-pattern" style="background-position: top">
    <section class="register">
      <div class="container" style="padding-top: 0">
        <form
          method="post"
          action="{% url 'register_view' %}"
          enctype="multipart/form-data"
          id="regForm"
        >
          {% csrf_token %}
          <div class="tab">
            <h2>Personal Details:</h2>
            {% if form.errors %}
            <div class="alert alert-danger" style="color: red">
              {{ form.errors }}
            </div>
            {% endif %}
            <div>
              <label for="first_name">First Name</label>
              {{ form.first_name }}
            </div>
            <div>
              <label for="last_name">Last Name</label>
              {{ form.last_name }}
            </div>
            <div>
              <label for="nick_name">Nick Name</label>
              {{ form.nick_name }}
            </div>
            <div>
              <label for="aiesec_email">AIESEC mail</label>
              {{ form.aiesec_email }}
            </div>
            <div>
              <label for="personal_email">Personal mail</label>
              {{ form.personal_email }}
            </div>
            <div>
              <label for="whatsapp_number">Whatsapp number</label>
              {{ form.whatsapp_number }}
            </div>
            <div>
              <label for="telegram_username">Telegram username</label>
              {{ form.telegram_username }}
            </div>
            <div>
              <label for="position">Position</label>
              {{ form.position }}
            </div>
            <div>
              <label for="position">Please select your generation</label>
              {{ form.generation }}
            </div>
            <div>
              <label for="other_roles">Other roles "Optional"</label>
              {{ form.other_roles}}
            </div>
            <div>
              <label for="entity">Your Nationality</label>
              {{ form.natonality }}
            </div>
            <div>
              <label for="entity">Entity</label>
              {{ form.entity }}
            </div>
            <div>
              <label for="region">Region</label>
              {{ form.region }}
            </div>
            <div>
              <label for="age">Date of Birth</label>
              {{ form.date_of_birth }}
            </div>
            <div>
              <label for="gender">Gender</label>
              {{ form.gender }}
            </div>
            <div>
              <label for="picture_of_the_delegate"
                >A picture of you "Maximum size is 2MB"</label
              >
              {{ form.picture_of_the_delegate }}
            </div>
            <div>
              <label for="shirt_size">What is your T-shirt size?</label>
              {{ form.shirt_size }}
            </div>
          </div>
          <div class="tab">
            <h2>IC profile setup:</h2>
            <div>
              <label for="room_preference">Username</label>
              {{ form.new_username }}
            </div>
            <div>
              <label for="food" class="food-pref">Create a password</label>
              {{ form.new_password1 }}
            </div>
            <div>
              <label for="allergies">Confirm you password</label>
              {{ form.new_password2 }}
            </div>
          </div>
          <div class="tab">
            <h2>Partners:</h2>
            <div>
              <label for="academic_background"
                >What is your academic background?</label
              >
              {{ form.academic_background }}
            </div>
            <div>
              <label for="partners_topics"
                >What topics would you like for partners to cover in their
                keynotes/workshops?</label
              >
              {{ form.partners_topics }}
            </div>
            <div>
              <label for="how_to_make_partners_spaces_relevant"
                >How can we make partner spaces more relevant for you?</label
              >
              {{ form.how_to_make_partners_spaces_relevant }}
            </div>
            <div>
              <label for="global_partner_for_key_note"
                >Which partner are you the most excited to attend their
                keynote/workshop?</label
              >
              {{ form.global_partner_for_key_note }}
            </div>
            <div>
              <label for="what_do_you_want_to_know_about_partners"
                >What do you want to know about our partners in IC 2024?</label
              >
              {{ form.what_do_you_want_to_know_about_partners }}
            </div>
            <div>
              <label for="career_confidence"
                >How confident do you feel about entering the field of
                work?</label
              >
              {{ form.career_confidence }}
            </div>
            <div>
              <label for="work_experience">What is your work experience?</label>
              {{ form.work_experience }}
            </div>
            <div>
              <label for="partners_for_career"
                >With which partner would you like to kick start your
                professional career?</label
              >
              {{ form.partners_for_career }}
            </div>
            <div>
              <label for="why_this_global_partner"
                >Why you choose that global partner?</label
              >
              {{ form.why_this_global_partner }}
            </div>
            <div>
              <label for="engagements"
                >From the following engagements which are you the most excited
                to attend?</label
              >
              {{ form.engagements }}
            </div>
            <label for="policies_1" class="policies_check"
              ><input
                type="checkbox"
                name="policies_1"
                value="1"
                id="policies_1"
              />
              I accept sharing the personal information with AIESEC in Egypt and
              AIESEC International according to the privacy policy.</label
            >
            <label for="policies_2" class="policies_check"
              ><input
                type="checkbox"
                name="policies_2"
                value="1"
                id="policies_2"
              />
              I accept
              <a class="cancellation_policy_button"
                >the cancellation policy.</a
              ></label
            >
            <label for="policies_1" class="policies_check"
              ><input
                type="checkbox"
                name="policies_1"
                value="1"
                id="policies_1"
              />
              I accept
              <a class="cancellation_policy_button"
                >50€ will be added to the fees of this round of registartions "the late round"</a
              ></label
            >
          </div>
          <div style="overflow: auto">
            <div style="float: center">
              <button type="button" id="prevBtn" onclick="nextPrev(-1)">
                Previous
              </button>
              <button type="button" id="nextBtn" onclick="nextPrev(1)">
                Next
              </button>
            </div>
          </div>

          <div style="text-align: center; margin-top: 40px">
            <span class="step"></span>
            <span class="step"></span>
            <span class="step"></span>
          </div>
        </form>
        <div class="popup_container">
          <div class="blocker"></div>
          <div class="policies_popup">
            <div class="close"></div>
            <h3>Cancellation Policy</h3>
            <ul class="cancellation-policy-list">
              <li>
                A Member Committee or Official Extension may replace a signed up
                delegate with another one, free of charge, until the 15th of May
                2024 pending the approval of AI of the delegate. After this, it
                is up to the discretion of the CC to accept any changes to
                delegates’ names. After the 15th of May 2024 the CC cannot
                guarantee the Visa for delegates as according to section 3. Any
                delegates changed after this date, which are accepted, but are
                not able to receive a Visa in time, is the full responsibility
                of the MC in question.
              </li>
              <li>
                Any cancellation up until the 15th of May 2024 shall be free of
                charge. Exceptions will be made for those that communicate that
                are looking for funding in written manner to ILMSC, AIVP Finance
                and CC at the moment of registering.
              </li>
              <li>
                Any cancellation between the 15th of May 2024 and 30th May 2024
                shall incur a cancellation fee of no more than 50% of the total
                delegate fees.
              </li>
              <li>
                Any cancellation of a delegate after the 30th May 2024, incurs a
                full delegate fee as cancellation.
              </li>
              <li>
                AI is not responsible for any losses of Member Committees or
                Expansions due to non-approval or delay of approval of
                replacement delegates.
              </li>
              <li>
                Delegates who were registered in 1st, 2nd and 3rd round by the
                30th May 2024 have not obtained their VISA and have not informed
                the CC about cancellation are fully liable for the conference
                fee.
              </li>
              <li>
                Delegates who cannot attend the conference due to rejection of
                VISA or non-reply on their application and inform the CC between
                15th May and 10th of June 2024, will be charged no more than 50%
                of the delegation fees.
              </li>
            </ul>
          </div>
        </div>
      </div>
    </section>
  </div>
</main>
<img
  src="{% static 'images/IC/footer_pattern.webp' %}"
  alt=""
  class="footer-pattern"
/>
<script>
  console.clear();

  function CountdownTracker(label, value) {
    var el = document.createElement("span");

    el.className = "flip-clock__piece";
    el.innerHTML =
      '<b class="flip-clock__card card"><b class="card__top"></b><b class="card__bottom"></b><b class="card__back"><b class="card__bottom"></b></b></b>' +
      '<span class="flip-clock__slot">' +
      label +
      "</span>";

    this.el = el;

    var top = el.querySelector(".card__top"),
      bottom = el.querySelector(".card__bottom"),
      back = el.querySelector(".card__back"),
      backBottom = el.querySelector(".card__back .card__bottom");

    this.update = function (val) {
      val = ("0" + val).slice(-2);
      if (val !== this.currentValue) {
        if (this.currentValue >= 0) {
          back.setAttribute("data-value", this.currentValue);
          bottom.setAttribute("data-value", this.currentValue);
        }
        this.currentValue = val;
        top.innerText = this.currentValue;
        backBottom.setAttribute("data-value", this.currentValue);

        this.el.classList.remove("flip");
        void this.el.offsetWidth;
        this.el.classList.add("flip");
      }
    };

    this.update(value);
  }

  // Calculation adapted from https://www.sitepoint.com/build-javascript-countdown-timer-no-dependencies/

  function getTimeRemaining(endtime) {
    let date = new Date(Date.parse("2024-06-30T23:59:59+03:00"));
    var t = Date.parse(date) - Date.parse(new Date());
    return {
      Total: t,
      Days: Math.floor(t / (1000 * 60 * 60 * 24)),
      Hours: Math.floor((t / (1000 * 60 * 60)) % 24),
      Minutes: Math.floor((t / 1000 / 60) % 60),
      Seconds: Math.floor((t / 1000) % 60),
    };
  }

  function getTime() {
    var t = new Date();
    return {
      Total: t,
      Hours: t.getHours() % 12,
      Minutes: t.getMinutes(),
      Seconds: t.getSeconds(),
    };
  }

  function Clock(countdown, callback) {
    countdown = countdown ? new Date(Date.parse(countdown)) : false;
    callback = callback || function () {};

    var updateFn = countdown ? getTimeRemaining : getTime;

    this.el = document.getElementById("flip");
    this.el.classList.add("flip-clock");

    var trackers = {},
      t = updateFn(countdown),
      key,
      timeinterval;
    console.log(t);

    for (key in t) {
      if (key === "Total") {
        continue;
      }
      trackers[key] = new CountdownTracker(key, t[key]);
      this.el.appendChild(trackers[key].el);
    }

    var i = 0;
    function updateClock() {
      timeinterval = requestAnimationFrame(updateClock);

      // throttle so it's not constantly updating the time.
      if (i++ % 10) {
        return;
      }

      var t = updateFn(countdown);
      if (t.Total < 0) {
        cancelAnimationFrame(timeinterval);
        for (key in trackers) {
          trackers[key].update(0);
        }
        callback();
        return;
      }

      for (key in trackers) {
        trackers[key].update(t[key]);
      }
    }

    setTimeout(updateClock, 500);
  }

  var deadline = new Date();
  // console.log(deadline)
  var c = new Clock(deadline);
  // document.body.appendChild(c.el);
</script>
<script>
  var currentTab = 0; // Current tab is set to be the first tab (0)
  showTab(currentTab); // Display the current tab

  function showTab(n) {
    // This function will display the specified tab of the form ...
    var x = document.getElementsByClassName("tab");
    x[n].style.display = "block";
    // ... and fix the Previous/Next buttons:
    if (n == 0) {
      document.getElementById("prevBtn").style.display = "none";
    } else {
      document.getElementById("prevBtn").style.display = "inline";
    }
    if (n == x.length - 1) {
      document.getElementById("nextBtn").innerHTML = "Submit";
    } else {
      document.getElementById("nextBtn").innerHTML = "Next";
    }
    // ... and run a function that displays the correct step indicator:
    fixStepIndicator(n);
  }

  function nextPrev(n) {
    // This function will figure out which tab to display
    var x = document.getElementsByClassName("tab");
    console.log(n);
    // Exit the function if any field in the current tab is invalid:
    if (n == 1 && !validateForm()) return false;
    // Hide the current tab:
    // Increase or decrease the current tab by 1:
    currentTab = currentTab + n;
    // if you have reached the end of the form... :
    if (currentTab >= x.length) {
      //...the form gets submitted:
      document.getElementById("regForm").submit();
      return false;
    }
    x[currentTab - n].style.display = "none";

    // Otherwise, display the correct tab:
    showTab(currentTab);
  }

  function validateForm() {
    // This function deals with validation of the form fields
    var x,
      y,
      i,
      valid = true;
    x = document.getElementsByClassName("tab");
    y = x[currentTab].getElementsByTagName("input");
    z = x[currentTab].getElementsByTagName("select");
    // A loop that checks every input field in the current tab:
    let checkboxCntFood = 0;
    let checkboxCntPolicies = 0;
    for (i = 0; i < y.length; i++) {
      // If a field is empty...
      if (y[i].value == "" && y[i].id != "id_other_roles") {
        // add an "invalid" class to the field:
        y[i].className += " invalid";
        // and set the current valid status to false:
        valid = false;
      }
      if (
        y[i].type == "checkbox" &&
        !y[i].checked &&
        y[i].id.includes("id_food")
      ) {
        checkboxCntFood++;
      }
      if (
        y[i].type == "checkbox" &&
        !y[i].checked &&
        y[i].id.includes("policies")
      ) {
        checkboxCntPolicies++;
      }
      if (checkboxCntFood == 6) {
        valid = false;
        y[i].className += " invalid";
        let errr = x[currentTab].querySelector(".food-pref");
        // errr.style.color = "red";
        console.log(errr);
        errr.classList.add("error_color");
      }
      if (checkboxCntPolicies >= 1) {
        valid = false;
        y[i].className += " invalid";
        let errr = x[currentTab].querySelectorAll(".policies_check");
        // errr.style.color = "red";
        errr.forEach((era) => {
          era.classList.add("error_color");
        });
      }
    }
    for (i = 0; i < z.length; i++) {
      // If a field is empty...
      if (z[i].value == "") {
        // add an "invalid" class to the field:
        z[i].className += " invalid";
        // and set the current valid status to false:
        valid = false;
      }
    }
    // If the valid status is true, mark the step as finished and valid:
    if (valid) {
      document.getElementsByClassName("step")[currentTab].className +=
        " finish";
    }
    return valid; // return the valid status
  }

  function fixStepIndicator(n) {
    // This function removes the "active" class of all steps...
    var i,
      x = document.getElementsByClassName("step");
    for (i = 0; i < x.length; i++) {
      x[i].className = x[i].className.replace(" active", "");
    }
    //... and adds the "active" class to the current step:
    x[n].className += " active";
  }

  const blocker = document.querySelector(".blocker");
  const popup = document.querySelector(".popup_container");
  const close = document.querySelector(".close");
  const cancellation_policy = document.querySelector(
    ".cancellation_policy_button"
  );

  const blocker_booklet = document.querySelector(".blocker_booklets");
  const popup_booklet = document.querySelector(".popup_container_booklets");
  const close_booklet = document.querySelector(".close_booklets");

  cancellation_policy.addEventListener("click", () => {
    popup.style.display = "block";
  });

  blocker.addEventListener("click", () => {
    popup.style.display = "none";
  });

  close.addEventListener("click", () => {
    popup.style.display = "none";
  });

  window.addEventListener("load", (event) => {
    popup_booklet.style.display = "block";
  });

  blocker_booklet.addEventListener("click", () => {
    popup_booklet.style.display = "none";
  });

  close_booklet.addEventListener("click", () => {
    popup_booklet.style.display = "none";
  });
</script>

{% endblock %}
